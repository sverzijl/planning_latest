/home/sverzijl/planning_latest/src/optimization/unified_node_model.py:260: UserWarning: Zero cost parameters detected: All route transport costs are 0, ambient storage costs are 0. This may cause solver to leave some variables uninitialized (valid behavior). Consider using small non-zero costs (e.g., 0.0001) if you encounter solution extraction issues.
  warnings.warn(warning_msg, UserWarning)
================================================================================
HiGHS SOLVER COMPREHENSIVE PERFORMANCE TEST
================================================================================
Loading data files...


================================================================================
PHASE 1: 1-WEEK HORIZON (Quick Baseline)
================================================================================

Creating model: 1-week horizon (2025-10-20 to 2025-10-27)

Unified Model Data Summary:
  Nodes: 11
    Manufacturing: 1
    Demand: 8
    With truck constraints: 1
  Routes: 10
  Truck schedules: 11
  Planning horizon: 2025-10-20 to 2025-10-27 (8 days)
  Products: 5
  Demand entries: 280
Model created

================================================================================
TEST: 1-week: HiGHS basic (no warmstart)
================================================================================
Warmstart: False
Time limit: 60s
MIP gap: 0.01

Building Unified Node Model...
  Sets defined: 11 nodes, 5 products, 8 dates, 10 routes
  Production dates for cohorts: 8 in horizon + 0 from initial inventory
  Cohort indices: 1,980 cohorts
  Shipment cohorts by origin node:
    6104: 280
    6122: 525
    6125: 420
    Lineage: 5
  Shipment cohort indices: 1,230
  Demand cohort indices: 1,120
  Changeover tracking: 8 production days, 40 product indicators
  Labor cost variables: 8 labor hour variables added
  Variables created successfully
  Adding core constraints...
  Changeover tracking constraints added (64 constraints)
  Labor cost constraints added (8 node-date pairs, 72 constraints)
  Pallet tracking enabled for states: ['frozen']
    - Pallet variables created: 180
    - Unit-tracked states: ['ambient', 'thawed']
  Holding cost enabled: 1,980 total cohorts (660 pallet-tracked)
  Core constraints added
  Truck constraints added (generalized for any node)
  Model complete and ready to solve
Running HiGHS 1.11.0 (git hash: 364c83a): Copyright (c) 2025 HiGHS under MIT licence terms
MIP  has 4015 rows; 5494 cols; 13494 nonzeros; 332 integer variables (144 binary)
Coefficient ranges:
  Matrix [1e-04, 2e+04]
  Cost   [1e+00, 1e+03]
  Bound  [1e+00, 2e+04]
  RHS    [1e-02, 1e+03]
Presolving model
2204 rows, 3179 cols, 7920 nonzeros  0s
1268 rows, 1872 cols, 4952 nonzeros  0s
1014 rows, 1653 cols, 4490 nonzeros  0s
736 rows, 1526 cols, 3707 nonzeros  0s
736 rows, 1511 cols, 3677 nonzeros  0s

Solving MIP model with:
   736 rows
   1511 cols (42 binary, 25 integer, 0 implied int., 1444 continuous, 0 domain fixed)
   3677 nonzeros

Src: B => Branching; C => Central rounding; F => Feasibility pump; J => Feasibility jump;
     H => Heuristic; L => Sub-MIP; P => Empty MIP; R => Randomized rounding; Z => ZI Round;
     I => Shifting; S => Solve LP; T => Evaluate node; U => Unbounded; X => User solution;
     z => Trivial zero; l => Trivial lower; u => Trivial upper; p => Trivial point

        Nodes      |    B&B Tree     |            Objective Bounds              |  Dynamic Constraints |       Work      
Src  Proc. InQueue |  Leaves   Expl. | BestBound       BestSol              Gap |   Cuts   InLp Confl. | LpIters     Time

 J       0       0         0   0.00%   -inf            807750.68101       Large        0      0      0         0     0.1s
 R       0       0         0   0.00%   279572.872467   725065.962416     61.44%        0      0      0       627     0.1s
 L       0       0         0   0.00%   285685.097361   286334.863836      0.23%     1426    123    110      1103     1.0s
         1       0         1 100.00%   285685.246395   286334.863836      0.23%     1395    123    110      3166     1.0s

Solving report
  Status            Optimal
  Primal bound      286334.863836
  Dual bound        285685.246395
  Gap               0.227% (tolerance: 1%)
  P-D integral      0.569038240532
  Solution status   feasible
                    286334.863836 (objective)
                    0 (bound viol.)
                    0 (int. viol.)
                    0 (row viol.)
  Timing            1.01 (total)
                    0.00 (presolve)
                    0.00 (solve)
                    0.00 (postsolve)
  Max sub-MIP depth 1
  Nodes             1
  Repair LPs        0 (0 feasible; 0 iterations)
  LP iterations     3166 (total)
                    0 (strong br.)
                    476 (separation)
                    2060 (heuristics)

RESULTS:
  Solve time: 1.9s
  Status: optimal
  Optimal: True
  Feasible: True
  Gap: 0.0023
  Total cost: $286,334.86

================================================================================
TEST: 1-week: HiGHS warmstart
================================================================================
Warmstart: True
Time limit: 60s
MIP gap: 0.01

ðŸš€ Warmstart Hints Generated (Campaign Pattern):
  Products: 5
  Weekdays: 6
  Hints: 18 (binary production flags)
  Pattern: 3 SKUs/weekday, 2 weekend days

  Demand Distribution:
    HELGAS GFREE WHOLEM 500G: 25.6% demand â†’ 4 weekday slots
    HELGAS GFREE TRAD WHITE 470G: 22.7% demand â†’ 3 weekday slots
    HELGAS GFREE MIXED GRAIN 500G: 21.9% demand â†’ 3 weekday slots
    WONDER GFREE WHITE 470G: 17.4% demand â†’ 3 weekday slots
    WONDER GFREE WHOLEM 500G: 12.4% demand â†’ 2 weekday slots

Building Unified Node Model...
  Sets defined: 11 nodes, 5 products, 8 dates, 10 routes
  Production dates for cohorts: 8 in horizon + 0 from initial inventory
  Cohort indices: 1,980 cohorts
  Shipment cohorts by origin node:
    6104: 280
    6122: 525
    6125: 420
    Lineage: 5
  Shipment cohort indices: 1,230
  Demand cohort indices: 1,120
  Changeover tracking: 8 production days, 40 product indicators
  Labor cost variables: 8 labor hour variables added
  Variables created successfully
  Adding core constraints...
  Changeover tracking constraints added (64 constraints)
  Labor cost constraints added (8 node-date pairs, 72 constraints)
  Pallet tracking enabled for states: ['frozen']
    - Pallet variables created: 180
    - Unit-tracked states: ['ambient', 'thawed']
  Holding cost enabled: 1,980 total cohorts (660 pallet-tracked)
  Core constraints added
  Truck constraints added (generalized for any node)
  Model complete and ready to solve

Applying warmstart hints...
  Warmstart applied: 18 variables initialized
Running HiGHS 1.11.0 (git hash: 364c83a): Copyright (c) 2025 HiGHS under MIT licence terms
MIP  has 4015 rows; 5494 cols; 13494 nonzeros; 332 integer variables (144 binary)
Coefficient ranges:
  Matrix [1e-04, 2e+04]
  Cost   [1e+00, 1e+03]
  Bound  [1e+00, 2e+04]
  RHS    [1e-02, 1e+03]
Presolving model
2204 rows, 3179 cols, 7920 nonzeros  0s
1268 rows, 1872 cols, 4952 nonzeros  0s
1014 rows, 1653 cols, 4490 nonzeros  0s
736 rows, 1526 cols, 3707 nonzeros  0s
736 rows, 1511 cols, 3677 nonzeros  0s

Solving MIP model with:
   736 rows
   1511 cols (42 binary, 25 integer, 0 implied int., 1444 continuous, 0 domain fixed)
   3677 nonzeros

Src: B => Branching; C => Central rounding; F => Feasibility pump; J => Feasibility jump;
     H => Heuristic; L => Sub-MIP; P => Empty MIP; R => Randomized rounding; Z => ZI Round;
     I => Shifting; S => Solve LP; T => Evaluate node; U => Unbounded; X => User solution;
     z => Trivial zero; l => Trivial lower; u => Trivial upper; p => Trivial point

        Nodes      |    B&B Tree     |            Objective Bounds              |  Dynamic Constraints |       Work      
Src  Proc. InQueue |  Leaves   Expl. | BestBound       BestSol              Gap |   Cuts   InLp Confl. | LpIters     Time

 J       0       0         0   0.00%   -inf            807750.68101       Large        0      0      0         0     0.1s
 R       0       0         0   0.00%   279572.872467   725065.962416     61.44%        0      0      0       627     0.1s
 L       0       0         0   0.00%   285685.097361   286334.863836      0.23%     1426    123    110      1103     1.4s
         1       0         1 100.00%   285685.246395   286334.863836      0.23%     1395    123    110      3166     1.4s

Solving report
  Status            Optimal
  Primal bound      286334.863836
  Dual bound        285685.246395
  Gap               0.227% (tolerance: 1%)
  P-D integral      0.832680167334
  Solution status   feasible
                    286334.863836 (objective)
                    0 (bound viol.)
                    0 (int. viol.)
                    0 (row viol.)
  Timing            1.44 (total)
                    0.00 (presolve)
                    0.00 (solve)
                    0.00 (postsolve)
  Max sub-MIP depth 1
  Nodes             1
  Repair LPs        0 (0 feasible; 0 iterations)
  LP iterations     3166 (total)
                    0 (strong br.)
                    476 (separation)
                    2060 (heuristics)
/home/sverzijl/planning_latest/src/optimization/unified_node_model.py:260: UserWarning: Zero cost parameters detected: All route transport costs are 0, ambient storage costs are 0. This may cause solver to leave some variables uninitialized (valid behavior). Consider using small non-zero costs (e.g., 0.0001) if you encounter solution extraction issues.
  warnings.warn(warning_msg, UserWarning)

RESULTS:
  Solve time: 2.2s
  Status: optimal
  Optimal: True
  Feasible: True
  Gap: 0.0023
  Total cost: $286,334.86


================================================================================
PHASE 2: 4-WEEK HORIZON (CBC Baseline Comparison)
================================================================================

Creating model: 4-week horizon (2025-10-20 to 2025-11-17)

Unified Model Data Summary:
  Nodes: 11
    Manufacturing: 1
    Demand: 8
    With truck constraints: 1
  Routes: 10
  Truck schedules: 11
  Planning horizon: 2025-10-20 to 2025-11-17 (29 days)
  Products: 5
  Demand entries: 880
Model created

================================================================================
TEST: 4-week: HiGHS basic (no warmstart)
================================================================================
Warmstart: False
Time limit: 300s
MIP gap: 0.01

Building Unified Node Model...
  Sets defined: 11 nodes, 5 products, 29 dates, 10 routes
  Production dates for cohorts: 29 in horizon + 0 from initial inventory
  Cohort indices: 18,675 cohorts
  Shipment cohorts by origin node:
    6104: 4060
    6122: 7980
    6125: 6090
    Lineage: 1265
  Shipment cohort indices: 19,395
  Demand cohort indices: 10,120
  Changeover tracking: 29 production days, 145 product indicators
  Labor cost variables: 29 labor hour variables added
  Variables created successfully
  Adding core constraints...
  Changeover tracking constraints added (232 constraints)
  Labor cost constraints added (29 node-date pairs, 261 constraints)
  Pallet tracking enabled for states: ['frozen']
    - Pallet variables created: 2,175
    - Unit-tracked states: ['ambient', 'thawed']
  Holding cost enabled: 18,675 total cohorts (6,225 pallet-tracked)
  Core constraints added
  Truck constraints added (generalized for any node)
  Model complete and ready to solve
Running HiGHS 1.11.0 (git hash: 364c83a): Copyright (c) 2025 HiGHS under MIT licence terms
MIP  has 33497 rows; 53797 cols; 132595 nonzeros; 2726 integer variables (522 binary)
Coefficient ranges:
  Matrix [1e-04, 2e+04]
  Cost   [1e+00, 1e+03]
  Bound  [1e+00, 2e+04]
  RHS    [1e-02, 1e+03]
Presolving model
26648 rows, 41536 cols, 108063 nonzeros  0s
18948 rows, 29754 cols, 78690 nonzeros  0s
13256 rows, 25930 cols, 64714 nonzeros  1s
12668 rows, 25169 cols, 62982 nonzeros  1s

Solving MIP model with:
   12668 rows
   25169 cols (182 binary, 1314 integer, 0 implied int., 23673 continuous, 0 domain fixed)
   62982 nonzeros

Src: B => Branching; C => Central rounding; F => Feasibility pump; J => Feasibility jump;
     H => Heuristic; L => Sub-MIP; P => Empty MIP; R => Randomized rounding; Z => ZI Round;
     I => Shifting; S => Solve LP; T => Evaluate node; U => Unbounded; X => User solution;
     z => Trivial zero; l => Trivial lower; u => Trivial upper; p => Trivial point

        Nodes      |    B&B Tree     |            Objective Bounds              |  Dynamic Constraints |       Work      
Src  Proc. InQueue |  Leaves   Expl. | BestBound       BestSol              Gap |   Cuts   InLp Confl. | LpIters     Time

 J       0       0         0   0.00%   -inf            2457174.1077       Large        0      0      0         0     1.8s
 R       0       0         0   0.00%   493997.917936   1446150.822365    65.84%        0      0      0     12675     3.4s
         0       0         0   0.00%   498608.281387   1446150.822365    65.52%     4618    250     25     16159    12.5s
         0       0         0   0.00%   499118.444344   1446150.822365    65.49%     6521    389     25     19209    17.9s
         0       0         0   0.00%   499934.450321   1446150.822365    65.43%     9076    498     25     21748    22.9s
 L       0       0         0   0.00%   499934.450321   512112.60359       2.38%     9076    498     25     21748    70.8s

Symmetry detection completed in 0.0s
Found 4 generator(s)

         2       1         0  50.00%   502406.78402    512112.60359       1.90%     9086    351     34     61334    83.4s
         3       0         0 100.00%   507432.894965   512112.60359       0.91%     9827    403     34     62107    85.8s

Solving report
  Status            Optimal
  Primal bound      512112.60359
  Dual bound        507432.894965
  Gap               0.914% (tolerance: 1%)
  P-D integral      45.958673639
  Solution status   feasible
                    512112.60359 (objective)
                    0 (bound viol.)
                    0 (int. viol.)
                    0 (row viol.)
  Timing            85.82 (total)
                    0.00 (presolve)
                    0.00 (solve)
                    0.00 (postsolve)
  Max sub-MIP depth 2
  Nodes             3
  Repair LPs        0 (0 feasible; 0 iterations)
  LP iterations     62107 (total)
                    8316 (strong br.)
                    9821 (separation)
                    31218 (heuristics)

RESULTS:
  Solve time: 96.2s
  Status: optimal
  Optimal: True
  Feasible: True
  Gap: 0.0091
  Total cost: $512,112.60

================================================================================
TEST: 4-week: HiGHS warmstart
================================================================================
Warmstart: True
Time limit: 300s
MIP gap: 0.01

ðŸš€ Warmstart Hints Generated (Campaign Pattern):
  Products: 5
  Weekdays: 21
  Hints: 63 (binary production flags)
  Pattern: 3 SKUs/weekday, 8 weekend days

  Demand Distribution:
    HELGAS GFREE WHOLEM 500G: 25.6% demand â†’ 4 weekday slots
    HELGAS GFREE TRAD WHITE 470G: 22.7% demand â†’ 3 weekday slots
    HELGAS GFREE MIXED GRAIN 500G: 21.9% demand â†’ 3 weekday slots
    WONDER GFREE WHITE 470G: 17.4% demand â†’ 3 weekday slots
    WONDER GFREE WHOLEM 500G: 12.4% demand â†’ 2 weekday slots

Building Unified Node Model...
  Sets defined: 11 nodes, 5 products, 29 dates, 10 routes
  Production dates for cohorts: 29 in horizon + 0 from initial inventory
  Cohort indices: 18,675 cohorts
  Shipment cohorts by origin node:
    6104: 4060
    6122: 7980
    6125: 6090
    Lineage: 1265
  Shipment cohort indices: 19,395
  Demand cohort indices: 10,120
  Changeover tracking: 29 production days, 145 product indicators
  Labor cost variables: 29 labor hour variables added
  Variables created successfully
  Adding core constraints...
  Changeover tracking constraints added (232 constraints)
  Labor cost constraints added (29 node-date pairs, 261 constraints)
  Pallet tracking enabled for states: ['frozen']
    - Pallet variables created: 2,175
    - Unit-tracked states: ['ambient', 'thawed']
  Holding cost enabled: 18,675 total cohorts (6,225 pallet-tracked)
  Core constraints added
  Truck constraints added (generalized for any node)
  Model complete and ready to solve

Applying warmstart hints...
  Warmstart applied: 63 variables initialized
Running HiGHS 1.11.0 (git hash: 364c83a): Copyright (c) 2025 HiGHS under MIT licence terms
MIP  has 33497 rows; 53797 cols; 132595 nonzeros; 2726 integer variables (522 binary)
Coefficient ranges:
  Matrix [1e-04, 2e+04]
  Cost   [1e+00, 1e+03]
  Bound  [1e+00, 2e+04]
  RHS    [1e-02, 1e+03]
Presolving model
26648 rows, 41536 cols, 108063 nonzeros  0s
18948 rows, 29754 cols, 78690 nonzeros  0s
13256 rows, 25930 cols, 64714 nonzeros  0s
12668 rows, 25169 cols, 62982 nonzeros  1s

Solving MIP model with:
   12668 rows
   25169 cols (182 binary, 1314 integer, 0 implied int., 23673 continuous, 0 domain fixed)
   62982 nonzeros

Src: B => Branching; C => Central rounding; F => Feasibility pump; J => Feasibility jump;
     H => Heuristic; L => Sub-MIP; P => Empty MIP; R => Randomized rounding; Z => ZI Round;
     I => Shifting; S => Solve LP; T => Evaluate node; U => Unbounded; X => User solution;
     z => Trivial zero; l => Trivial lower; u => Trivial upper; p => Trivial point

        Nodes      |    B&B Tree     |            Objective Bounds              |  Dynamic Constraints |       Work      
Src  Proc. InQueue |  Leaves   Expl. | BestBound       BestSol              Gap |   Cuts   InLp Confl. | LpIters     Time

 J       0       0         0   0.00%   -inf            2457174.1077       Large        0      0      0         0     1.4s
 R       0       0         0   0.00%   493997.917936   1446150.822365    65.84%        0      0      0     12675     2.9s
         0       0         0   0.00%   498608.281387   1446150.822365    65.52%     4618    250     25     16159    12.3s
         0       0         0   0.00%   499717.666542   1446150.822365    65.44%     6969    421     25     19619    17.6s
 L       0       0         0   0.00%   499934.450321   512112.60359       2.38%     9076    498     25     21748    70.5s

Symmetry detection completed in 0.0s
Found 4 generator(s)

         2       1         0  50.00%   502406.78402    512112.60359       1.90%     9086    351     34     61334    82.4s
         3       0         0 100.00%   507432.894965   512112.60359       0.91%     9827    403     34     62107    84.8s

Solving report
  Status            Optimal
  Primal bound      512112.60359
  Dual bound        507432.894965
  Gap               0.914% (tolerance: 1%)
  P-D integral      45.9688187322
  Solution status   feasible
                    512112.60359 (objective)
                    0 (bound viol.)
                    0 (int. viol.)
                    0 (row viol.)
  Timing            84.82 (total)
                    0.00 (presolve)
                    0.00 (solve)
                    0.00 (postsolve)
  Max sub-MIP depth 2
  Nodes             3
  Repair LPs        0 (0 feasible; 0 iterations)
  LP iterations     62107 (total)
                    8316 (strong br.)
                    9821 (separation)
                    31218 (heuristics)

RESULTS:
  Solve time: 96.0s
  Status: optimal
  Optimal: True
  Feasible: True
  Gap: 0.0091
  Total cost: $512,112.60

================================================================================
SUMMARY: HiGHS Performance Comparison
================================================================================

Configuration                            Time (s)     Status          Gap        Cost ($)       
---------------------------------------- ------------ --------------- ---------- ---------------
1-week: HiGHS basic (no warmstart)       1.9          optimal         0.0023     286,335        
1-week: HiGHS warmstart                  2.2          optimal         0.0023     286,335        
4-week: HiGHS basic (no warmstart)       96.2         optimal         0.0091     512,113        
4-week: HiGHS warmstart                  96.0         optimal         0.0091     512,113        

BASELINE REFERENCES:                    
Continuous (no binary vars)              35-45        OPTIMAL         <0.01      ~varies        
CBC (binary vars, no warmstart)          226          OPTIMAL         <0.01      ~varies        
CBC (binary vars, WITH warmstart)        >300         TIMEOUT         ~1.0       ~varies        

================================================================================
ANALYSIS & RECOMMENDATIONS
================================================================================

Best 4-week configuration: 4-week: HiGHS warmstart
  Solve time: 96.0s
  Status: optimal

Comparison to CBC baseline (226s):
  Speedup: 2.35x
  Assessment: GOOD - HiGHS is faster than CBC

Warmstart compatibility:
  HiGHS supports warmstart parameter (no errors)
  Warmstart does NOT improve solve time (may be ignored by solver)

================================================================================
TEST COMPLETE
================================================================================
